spark-sql> select * from test;
1027765 4822    172 20151028
1027765 4822    172 20151026
881482  4822    172 20151129
1027765 4822    172 20151007
1027765 4822    172 20151011
1027765 4822    172 20151010
1027765 4822    172 20151023
1027765 4822    172 20151022
1027765 820 172 20151030
1027765 820 172 20151023
1027765 820 172 20151114
1027765 820 172 20151127
881482  6709    172 20151121
881482  7830    172 20151121
881482  43  172 20151027
Time taken: 0.259 seconds, Fetched 15 row(s)

###########################
concat_ws拼接，collect_set集合。
###########################
spark-sql> select uid, lid, concat_ws(':',collect_set(mid)) as mids from test group by uid,lid;
881482  172     4822:6709:7830:43
1027765 172 4822:820
Time taken: 1.933 seconds, Fetched 2 row(s)